# DOM (Document Object Model)

- HTML 요소들의 구조화된 표현

- 원본 HTML 문서의 객체 기반 표현 방식임

- HTML 문서/웹 페이지에 대한 인터페이스

- 여러 프로그램들이 페이지의 컨텐츠 및 구조, 스타일을 읽고 조작할 수 있도록 API를 제공함

- 단순하게 텍스트로 구성된 HTML 문서의 내용을 트리형태로 구조화해서 웹 페이지와 프로그래밍 언어를 연결시켜주는 역할을 함 (다양한 프로그램에서 사용될 수 있음)

- 뷰 포트에 무엇을 렌더링 할지 결정하기 위해 사용됨
- 페이지의 컨텐츠 및 구조, 스타일이 자바스크립트 프로그램에 의해 수정되기 위해 사용됨

- 자바스크립트에 의해 수정될 수 있는 동적 모델이어야 함

- 가상 요소를 포함하지 않음 <br>예) `::after`

- 보이지 않는 요소를 포함함 <br>예) `display: none`

<br>

- DOM은 HTML 문서의 객체 표현이고, 외부를 향하는 자바스크립트와 같은 HTML 요소의 연결지점임

## 웹 페이지 형성 과정

1. 브라우저는 읽어들인 문서를 파싱하여 최종적으로 어떤 내용을 페이지에 렌더링할지를 결정함
   - 이 과정에서 `Render Tree`가 생성됨
2. 브라우저는 해당 렌더링 과정을 수행함

### Render Tree

- 웹 페이지에 표시될 HTML 요소들과 이와 관련된 스타일 요소들로 구성됨

- 브라우저가 렌더 트리를 생성하기 위해 두가지 모델(DOM과 CSSOM)이 필요함

- 렌더 트리는 시각적 속성이 있는 사각형(색상, 면적 등)을 포함하고 있으며 정해진 순서대로 화면에 표시된다.

- 렌더 트리 생성이 끝나면 배치가 시작된다. (각 노드가 화면의 정확한 위치에 표시 됨)

- 이후에는 UI 백엔드에서 렌더 트리의 각 노드를 가로지르며 형상을 만들어내는 그리기 과정이 진행됨
  (렌더링 엔진은 보다 나은 사용자 경험을 위해 가능한한 빨리 내용을 표시하며, 모든 HTML을 파싱할 때까지 기다리지 않고 배치와 그리기 과정을 시작한다. 네트워크로부터 나머지 내용이 전송되기를 기다리는 동시에 받은 내용의 일부를 먼저 화면에 표시하는 것이다.)

#### CSSOM (Cascading Style Sheets Object Model)

- 요소들과 관련된 스타일 정보의 구조화된 표현

## DOM의 표현 형태

- DOM의 개체 구조는 '노드 트리'로 표현됨<BR>
  (하나의 부모 줄기가 여러 개의 자식 나뭇가지를 가지고 있고, 각각의 나뭇가지는 잎들을 가질 수 있는 나무와 같은 구조로 이루어져 있음)

- 예제

```html
<!DOCTYPE html>
<html lang="ko">
  <head>
    <title>Toy Project</title>
  </head>
  <body>
    <h1>Simple project</h1>
    <p>what to do</p>
  </body>
</html>
```

- 이 예제에서 루트 요소인 `<html>`은 '부모 줄기', 루트 요소에 내포된 태그들은 `자식 나뭇가지`, 요소 안의 컨텐츠는 `잎`에 해당됨

## DOM이 아닌 것

1. DOM은 HTML이 아니다

- DOM은 HTML 문서로부터 생성되지만 항상 동일하지는 않다. DOM이 원본 HTML 소스와 다를 수 있는 케이스는 2가지가 존재한다.

- DOM이 HTML 소스와 다른 2가지 케이스

  1.  작성된 HTML 문서가 유효하지 않은 경우
      - DOM은 유효한 HTML 문서의 인터페이스이다. DOM을 생성하는 동안, 브라우저는 유효하지 않은 HTML 코드를 올바르게 교정한다.
      ```HTML
      <!doctype html>
      <html>
        Toy project
      </html>
      ```
      - 이 예제에서 문서에 유효한 HTML 규칙의 필수 사항인 `<head>`와 `<body>`요소가 빠져있다. 하지만 생성된 DOM 트리에는 빠진 `<head>`와 `<body>`요소르르 넣어서 올바르게 교정되어서 나타난다.
  2.  자바스크립트에 의해 DOM이 수정될 때

      - DOM은 HTML 문서의 내용을 볼 수 있는 인터페이스 역할을 하는 동시에 동적 자원이 되어 수정할 수 있다.
      - ex) 자바스크립트를 사용해서 DOM에 새로운 노드를 추가할 수 있다

            ```JS
            var newPaper = document.createElement('p');
            var pageContents = document.createTextNode("I'm new!");
            newPaper.appendChild(pageContetns);
            document.body.appendChild(newPaper);
            ```

2. DOM은 브라우저에서 보이지 않는다

- 브라우저의 뷰 포트(화면에 보여지는 영역)에 보이는 것은 Render Tree(DOM + CSSOM)이다 <BR> (Render Tree는 스크린에 그려지는 것으로 구성되어 있으므로 DOM과 다르다)
- 렌더링 되는 요소만이 관련이 있으므로 시각적으로 보이지 않는 요소는 제외된다.

- 예시 (`display: none`스타일 속성을 가지고 있는 요소)

```html
<!DOCTYPE html>
<html lang="ko">
  <head></head>
  <body>
    <h1>Hello, world</h1>
    <p style="display: none;">How do you do?</p>
  </body>
</html>
```

- DOM은 `<p>`요소를 포함시킴

- 하지만 DOM과 달리 Render Tree에 해당하는 뷰 포트에 표시되는 내용은 `<p>`요소를 포함하지 않음 (보이지 않게 css설정 되어있으므로)

3. DOM은 개발도구에서 보이지 않는다

- 개발도구 요소 검사기는 DOM과 가장 가까운 근사치를 제공함 (하지만 개발도구의 요소 검사기는 DOM에 없는 추가적인 정보를 포함함)

- 예제 (CSS의 가상 요소)
  - `:before`과 `::after` 선택자를 사용하여 생성된 가상 요소는 CSSOM과 렌더 트리의 일부를 구성함<br>(DOM은 오직 원본 HTML 문서로부터 빌드 되고, 요소에 적용되는 스타일을 포함하지 않으므로 기술적으로 가상요소는 DOM의 일부가 아니다. 따라서 자바스크립트에 의해서 가상요소가 수정될 수 없다)
